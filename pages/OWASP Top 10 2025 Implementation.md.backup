# OWASP Top 10 2025 - Implementation Status

| #   | Category                                             | Status               | File                                                  |
| --- | ---------------------------------------------------- | -------------------- | ----------------------------------------------------- |
| 1   | **A01:2025 - Broken Access Control**                 | ✅ Implemented        | [bac.py](service/attacks/core/bac.py)                 |
|     | SSRF (rolled into A01)                               | ✅ Implemented        | [ssrf.py](service/attacks/core/ssrf.py)               |
| 2   | **A02:2025 - Security Misconfiguration**             | ✅ Implemented        | [misconfig.py](service/attacks/core/misconfig.py)     |
| 3   | **A03:2025 - Software Supply Chain Failures**        | ⚠️ To be implemented | -                                                     |
| 4   | **A04:2025 - Cryptographic Failures**                | ⚠️ To be implemented | -                                                     |
| 5   | **A05:2025 - Injection**                             | ✅ Implemented        | [injection.py](service/attacks/core/injection.py)     |
| 6   | **A06:2025 - Insecure Design**                       | ⚠️ To be implemented | -                                                     |
| 7   | **A07:2025 - Authentication Failures**               | ✅ Implemented        | [credentials.py](service/attacks/core/credentials.py) |
|     | SSH Authentication                                   | ✅ Implemented        | [ssh.py](service/attacks/core/ssh.py)                 |
| 8   | **A08:2025 - Software or Data Integrity Failures**   | ⚠️ To be implemented | -                                                     |
| 9   | **A09:2025 - Logging & Alerting Failures**           | ⚠️ To be implemented | -                                                     |
| 10  | **A10:2025 - Mishandling of Exceptional Conditions** | ⚠️ To be implemented | -                                                     |

---

## Summary

- **Implemented:** 5/10 (50%)
- **To be implemented:** 5/10 (50%)

## Additional Files

- [ping.py](service/attacks/core/ping.py) - Network connectivity testing (utility)

# How to test

## A01: Broken Access Control

  Test unauthorized access to resources:

- Try accessing admin endpoints without auth: http://localhost:8042/system (Orthanc)

- Test DICOM image access without credentials

- Check if you can access other users' studies

- Try path traversal: http://localhost:8042/../../../etc/passwd
  
  curl http://localhost:8042/patients
  curl http://localhost:8042/system
  curl http://localhost:8080/studies # Dicoogle

## A02: Security Misconfiguration

  Check default configs:

- Default credentials (Orthanc often uses orthanc:orthanc)

- Exposed debug endpoints

- Verbose error messages revealing system info

- Check for exposed .env files or config backups
  
  curl -u orthanc:orthanc http://localhost:8042/system
  curl http://localhost:8080/config
  curl http://localhost:3001/.env

## A03: Supply Chain Failures

  Audit dependencies:
  docker compose -p pacs-complete-dev config | grep image:
  docker scout cves in-cypher.dev/orthanc:latest
  npm audit # for dicomweb-js

## A04: Cryptographic Failures

- Check if HTTP instead of HTTPS

- Test unencrypted DICOM transmission

- Look for passwords in logs/configs

- Check database encryption
  
  curl -v http://localhost:8042 # Should redirect to HTTPS
  grep -r "password" /home/fsgrey/Achilles/configs/standard/pacs-complete-dev/

## A05: Injection

  Test SQL/NoSQL/Command injection:

- DICOM tag injection

- SQL injection in search queries

- LDAP injection if using directory auth
  
  curl "http://localhost:8080/search?query='; DROP TABLE studies;--"
  curl "http://localhost:8042/tools/find" -d '{"Level":"Study","Query":{"PatientID":"*"}}'

## A06: Insecure Design

  Architectural flaws:

- Rate limiting missing

- No session timeout

- Lack of security boundaries

- Missing threat modeling
  
  Test rate limiting
  
  for i in {1..1000}; do curl http://localhost:8042/patients & done

## A07: Authentication Failures

- Brute force credentials

- Test session fixation

- Check credential stuffing

- Weak password policies
  
  hydra -l orthanc -P /usr/share/wordlists/rockyou.txt localhost -s 8042 http-get /

## A08: Software/Data Integrity

- Unsigned packages

- No integrity checks on DICOM files

- Missing code signing

- Deserialization vulnerabilities

## A09: Logging & Alerting Failures

  Check logs:
  docker compose -p pacs-complete-dev logs | grep -i "error\|fail\|auth"

**Test if failed logins are logged:**

  curl -u wrong:creds http://localhost:8042/system

## A10: Mishandling Exceptional Conditions

- Send malformed DICOM files

- Trigger errors with invalid inputs

- Test resource exhaustion

**Send corrupted DICOM:**

  curl -X POST http://localhost:8042/instances --data-binary "@corrupted.dcm"

## Automated Tools

**Install security scanners:**

  sudo apt install nikto sqlmap nmap

**Scan web interfaces:**

  nikto -h http://localhost:8042
  nikto -h http://localhost:8080

**Port scan:**

  nmap -sV -p 1045,3001,3002,4242,5432,6666,8042,8080,8082 localhost

**OWASP ZAP:**

  docker run -t zaproxy/zap-stable zap-baseline.py -t http://host.docker.internal:8042
